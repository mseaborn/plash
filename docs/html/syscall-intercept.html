<html><head><meta http-equiv="Content-Type" content="text/html; charset=ANSI_X3.4-1968"><title>Why not do interception of system calls using, for example, ptrace?</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="Plash: the Principle of Least Authority shell"><link rel="up" href="env.html" title="Chapter&#160;3.&#160;Plash's restricted execution environment"><link rel="prev" href="env-dir-fds.html" title="Directory file descriptors"><link rel="next" href="chroot-comparison.html" title="How does Plash compare with chroot jails?"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Why not do interception of system calls using, for example, ptrace?</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="env-dir-fds.html">Prev</a>&#160;</td><th width="60%" align="center">Chapter&#160;3.&#160;Plash's restricted execution environment</th><td width="20%" align="right">&#160;<a accesskey="n" href="chroot-comparison.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="syscall-intercept"></a>Why not do interception of system calls using, for example, ptrace?</h2></div></div></div><p>Another way to do what Plash does is to intercept system calls.</p><p>One way to do this is to use the ptrace mechanism, which is available
in standard versions of Linux.  Using ptrace, all the syscalls a
process makes can be handled by another process.  The problems with
ptrace are security and performance.  Firstly, fork() cannot be
handled securely with ptrace.  Secondly, redirecting system calls with
ptrace is slow, but it can't be done selectively.  ptrace doesn't let
you redirect some syscalls (such as "open") while letting others
through (such as "read").  (See David Wagner's Master's thesis,
"Janus: an approach for confinement of untrusted applications".)</p><p>systrace provides a mechanism that is similar to ptrace.  It provides
better performance, because it allows system calls to be intercepted
selectively.  It allows race-free handling of fork().  However, it is
not part of standard releases of Linux.  Using it requires recompiling
your kernel and rebooting.  Plash is intended to be immediately usable
without recompiling your kernel.  That said, it would be useful to add
systrace support to Plash in addition to its current approach.</p><p>Ostia provides a different mechanism intercepting system calls.
Rather than redirecting a system call to a second process, it will
bounce a system call back to the process that issued it.  Then, much
like in Plash, the process makes the request via a socket.  This
approach is simpler than systrace.  Unlike Plash, it doesn't require
modifying libc.  A separate library handles the syscalls that get
bounced back.  Ostia is implemented by a Linux kernel module.
Unfortunately, the code is not publicly available.  (See "Ostia: A
Delegating Architecture for Secure System Call Interposition" by Tal
Garfinkel, Ben Pfaff and Mendel Rosenblum, 2004.)</p><p>Plash could benefit by using syscall interception.  Using chroot and
UIDs, Plash is able to control a process's ability to access the
filesystem and interfere with other processes.  However, Plash does
not prevent a process from connecting to or listening on network
sockets.  This could be done if there was a way for Plash to prevent a
process from doing connect() and bind() system calls.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="env-dir-fds.html">Prev</a>&#160;</td><td width="20%" align="center"><a accesskey="u" href="env.html">Up</a></td><td width="40%" align="right">&#160;<a accesskey="n" href="chroot-comparison.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Directory file descriptors&#160;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&#160;How does Plash compare with chroot jails?</td></tr></table></div></body></html>
